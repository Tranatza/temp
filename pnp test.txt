# Parameters
$siteUrl = "<site-url>"
$libraryName = "<library-name>"
$excelFileName = "<excel-file-name>"
$note = "<note>"
$versionNumber = "<version-number>"
$remoteFilePath = "<remote-file-path>"

# Connect to SharePoint Online
Connect-PnPOnline -Url $siteUrl -UseWebLogin

# Get the SharePoint library
$library = Get-PnPList -Identity $libraryName

# Get the Excel file
$fileItem = Get-PnPListItem -List $libraryName -Query "<View><Query><Where><Eq><FieldRef Name='FileLeafRef'/><Value Type='Text'>$excelFileName</Value></Eq></Where></Query></View>"

# Upload the modified file
Set-PnPFile -Url $fileItem["FileRef"] -SourceFilePath $remoteFilePath -CheckIn -CheckInComment $note

# Set custom semantic version number
if ($versionNumber) {
    $fileItem["SemanticVersion"] = $versionNumber
    $fileItem.SystemUpdate()
    Write-Host "Updated file version to: $versionNumber"
}

Write-Host "Excel file updated successfully."
