# Parameters
$siteUrl = "<site-url>"
$libraryName = "<library-name>"
$subfolderUrl = "/<subfolder-path>"
$excelFileName = "<excel-file-name>"
$note = "<note>"
$versionNumber = "<version-number>"
$remoteFilePath = "<remote-file-path>"

# Connect to SharePoint Online
Connect-PnPOnline -Url $siteUrl -UseWebLogin

# Get the SharePoint library
$library = Get-PnPList -Identity $libraryName

# Get the Excel file
$file = Get-PnPFile -Url "/$libraryName$subfolderUrl/$excelFileName"

# Upload the modified file
Set-PnPFile -Url $file.ServerRelativeUrl -SourceFilePath $remoteFilePath -CheckIn -CheckInComment $note

# Set custom semantic version number
if ($versionNumber) {
    $file.ListItemAllFields["SemanticVersion"] = $versionNumber
    $file.ListItemAllFields.Update()
    $file.Context.ExecuteQuery()
    Write-Host "Updated file version to: $versionNumber"
}

Write-Host "Excel file updated successfully."
